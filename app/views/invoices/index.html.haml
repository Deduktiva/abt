= page_header_with_new_button('Listing invoices', new_invoice_path)

- if @available_years.any?
  .year-pagination.mb-4
    %nav{"aria-label" => "Year navigation"}
      %ul.pagination.pagination-sm.justify-content-center
        - @available_years.each do |year|
          %li.page-item{class: (@selected_year == year ? 'active' : '')}
            - if @selected_year == year
              %span.page-link= year
            - else
              = link_to year, invoices_path(year: year), class: 'page-link'

%table.table.table-striped.table-sm
  %tr
    %th Document#
    %th Customer
    %th Project
    %th Date
    %th Cust Reference
    %th Cust Order No
    %th{:width => "3%"}
    %th{:width => "3%"}
    %th{:width => "3%"}
    %th{:width => "3%"}

  - @invoices.each do |invoice|
    %tr
      %td= invoice.document_number
      %td= invoice.customer.name
      %td= invoice.project && invoice.project.matchcode
      %td= invoice.date
      %td= invoice.cust_reference
      %td= invoice.cust_order
      %td
        - if invoice.published? and not invoice.attachment.nil?
          = link_to 'PDF', attachment_path(invoice.attachment), target: '_blank', data: { turbo: false }, class: 'btn btn-sm btn-outline-success py-0'
      %td= list_action_link('Show', invoice, :show)
      %td
        - unless invoice.published?
          = list_action_link('Edit', edit_invoice_path(invoice), :edit)
      %td
        - unless invoice.published?
          = destroy_link(invoice, "Are you sure you want to delete invoice \"#{invoice.document_number || "##{invoice.id}"}\"?")

